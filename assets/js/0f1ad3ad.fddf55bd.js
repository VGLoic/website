"use strict";(self.webpackChunk_semaphore_protocol_website=self.webpackChunk_semaphore_protocol_website||[]).push([[204],{3905:function(e,t,r){r.d(t,{Zo:function(){return m},kt:function(){return d}});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var s=n.createContext({}),l=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},m=function(e){var t=l(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,m=p(e,["components","mdxType","originalType","parentName"]),c=l(r),d=o,h=c["".concat(s,".").concat(d)]||c[d]||u[d]||a;return r?n.createElement(h,i(i({ref:t},m),{},{components:r})):n.createElement(h,i({ref:t},m))}));function d(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=c;var p={};for(var s in t)hasOwnProperty.call(t,s)&&(p[s]=t[s]);p.originalType=e,p.mdxType="string"==typeof e?e:o,i[1]=p;for(var l=2;l<a;l++)i[l]=r[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}c.displayName="MDXCreateElement"},866:function(e,t,r){r.r(t),r.d(t,{contentTitle:function(){return s},default:function(){return c},frontMatter:function(){return p},metadata:function(){return l},toc:function(){return m}});var n=r(3117),o=r(102),a=(r(7294),r(3905)),i=["components"],p={sidebar_position:2,title:"Groups"},s="Semaphore groups",l={unversionedId:"guides/groups",id:"version-V2/guides/groups",title:"Groups",description:"\x3c!--Working outline",source:"@site/versioned_docs/version-V2/guides/groups.md",sourceDirName:"guides",slug:"/guides/groups",permalink:"/docs/guides/groups",editUrl:"https://github.com/semaphore-protocol/website/edit/main/versioned_docs/version-V2/guides/groups.md",tags:[],version:"V2",sidebarPosition:2,frontMatter:{sidebar_position:2,title:"Groups"},sidebar:"version-V2/mySidebar",previous:{title:"Identities",permalink:"/docs/guides/identities"},next:{title:"Proofs",permalink:"/docs/guides/proofs"}},m=[{value:"Create groups",id:"create-groups",children:[{value:"Create off-chain groups",id:"create-off-chain-groups",children:[],level:3},{value:"Create on-chain groups",id:"create-on-chain-groups",children:[],level:3}],level:2}],u={toc:m};function c(e){var t=e.components,r=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"semaphore-groups"},"Semaphore groups"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/docs/glossary/#semaphore-group"},"Semaphore groups")," contain ",(0,a.kt)("a",{parentName:"p",href:"/docs/glossary/#identity-commitment"},"identity commitments")," of group members.\nExample uses of groups include the following:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Poll question that attendees join to rate an event."),(0,a.kt)("li",{parentName:"ul"},"Ballot that members join to vote on a proposal."),(0,a.kt)("li",{parentName:"ul"},"Whistleblowers who are verified employees of an organization.")),(0,a.kt)("p",null,"Semaphore groups are actually incremental Merkle trees, and the group members (i.e. identity commitments) are tree leaves. Semaphore implementations of groups thus also need two parameters:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Tree depth"),": determines the maximum number of members a group can contain (",(0,a.kt)("inlineCode",{parentName:"li"},"max size = 2 ^ tree depth"),")."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Zero value"),": is used to calculate the zeroes nodes of the incremental Merkle tree.")),(0,a.kt)("h2",{id:"create-groups"},"Create groups"),(0,a.kt)("p",null,"Use the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/semaphore-protocol/semaphore.js/blob/main/packages/group"},(0,a.kt)("inlineCode",{parentName:"a"},"@semaphore-protocol/group"))," library to create off-chain groups, or the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/semaphore-protocol/semaphore/blob/main/contracts/base/SemaphoreGroups.sol"},(0,a.kt)("inlineCode",{parentName:"a"},"SemaphoreGroups"))," contract to create on-chain groups."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#create-off-chain-groups"},(0,a.kt)("strong",{parentName:"a"},"Create off-chain groups"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#create-on-chain-groups"},(0,a.kt)("strong",{parentName:"a"},"Create on-chain groups")))),(0,a.kt)("h3",{id:"create-off-chain-groups"},"Create off-chain groups"),(0,a.kt)("p",null,"You can create an instance of the ",(0,a.kt)("inlineCode",{parentName:"p"},"Group")," class without passing any parameters, or you can specify the ",(0,a.kt)("inlineCode",{parentName:"p"},"treeDepth")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"zeroValue")," values."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},'import { Group } from "@semaphore-protocol/group"\n\n// Default parameters: treeDepth = 20, zeroValue = BigInt(0).\nconst group = new Group()\n')),(0,a.kt)("p",null,"Members can be added one at a time or in batches."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"group.addMember(identityCommitment)\n// or\ngroup.addMembers(identityCommitments)\n")),(0,a.kt)("p",null,"Members can also be removed from a group. Simply pass the member index:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"group.removeMember(0)\n")),(0,a.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"When a member is removed actually its value is updated to be equal to ",(0,a.kt)("inlineCode",{parentName:"p"},"zeroValue"),". The length of the ",(0,a.kt)("inlineCode",{parentName:"p"},"group.members")," array will then be the same."))),(0,a.kt)("h3",{id:"create-on-chain-groups"},"Create on-chain groups"),(0,a.kt)("p",null,"The ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/semaphore-protocol/semaphore/tree/main/contracts/base/SemaphoreGroups.sol"},(0,a.kt)("inlineCode",{parentName:"a"},"SemaphoreGroups"))," contract uses a the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/privacy-scaling-explorations/zk-kit/blob/main/packages/incremental-merkle-tree.sol/contracts/IncrementalBinaryTree.sol"},(0,a.kt)("inlineCode",{parentName:"a"},"IncrementalBinaryTree"))," library and provides methods to create groups and add/remove members."),(0,a.kt)("p",null,"To use on-chain groups, import ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/semaphore-protocol/semaphore/blob/main/contracts/base/SemaphoreGroups.sol"},(0,a.kt)("inlineCode",{parentName:"a"},"SemaphoreGroups"))," and call its internal methods. The following code sample shows how the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/semaphore-protocol/semaphore/blob/main/contracts/Semaphore.sol"},(0,a.kt)("inlineCode",{parentName:"a"},"Semaphore"))," contract uses ",(0,a.kt)("inlineCode",{parentName:"p"},"SemaphoreGroups"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sol"},'// SPDX-License-Identifier: MIT\npragma solidity ^0.8.4;\n\nimport "./interfaces/ISemaphore.sol";\nimport "./base/SemaphoreCore.sol";\nimport "./base/SemaphoreGroups.sol";\n\n/// @title Semaphore\ncontract Semaphore is ISemaphore, SemaphoreCore, SemaphoreGroups {\n\n    ...\n\n    function createGroup(\n        uint256 groupId,\n        uint8 depth,\n        uint256 zeroValue,\n        address admin\n    ) external override onlySupportedDepth(depth) {\n        _createGroup(groupId, depth, zeroValue);\n\n        groupAdmins[groupId] = admin;\n\n        emit GroupAdminUpdated(groupId, address(0), admin);\n    }\n\n    function addMember(uint256 groupId, uint256 identityCommitment) external override onlyGroupAdmin(groupId) {\n        _addMember(groupId, identityCommitment);\n    }\n\n    function removeMember(\n        uint256 groupId,\n        uint256 identityCommitment,\n        uint256[] calldata proofSiblings,\n        uint8[] calldata proofPathIndices\n    ) external override onlyGroupAdmin(groupId) {\n        _removeMember(groupId, identityCommitment, proofSiblings, proofPathIndices);\n    }\n\n    ...\n}\n')))}c.isMDXComponent=!0}}]);